<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…ÙˆÙ„Ø¯ ØµÙˆØ± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Stable Horde (Ø¥ØµØ¯Ø§Ø± Ø¬Ø¯ÙŠØ¯)</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,"Noto Sans Arabic",Arial;background:#f8f9fb;margin:0;padding:0;direction:rtl;color:#222}
    header{background:#0b66ff;color:white;padding:16px;text-align:center}
    h1{margin:0;font-size:1.6rem}
    main{max-width:880px;margin:20px auto;padding:16px}
    .card{background:white;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.05);padding:18px;margin-top:14px}
    label{display:block;margin-top:8px;font-weight:500}
    textarea,input,select{width:100%;padding:8px;margin-top:4px;border:1px solid #ccc;border-radius:8px;font-size:1rem}
    button{margin-top:12px;padding:10px 18px;border-radius:8px;border:0;background:#0b66ff;color:white;cursor:pointer;font-size:1rem}
    button:disabled{opacity:0.6;cursor:not-allowed}
    #status{font-size:0.9rem;color:#444;margin-top:10px}
    img{max-width:100%;border-radius:10px;margin-top:12px;display:block}
    footer{margin-top:40px;text-align:center;font-size:0.8rem;color:#555}
  </style>
</head>
<body>
<header>
  <h1>ğŸ§  Ù…ÙˆÙ„Ø¯ Ø§Ù„ØµÙˆØ± Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (Stable Horde)</h1>
</header>
<main>
  <div class="card">
    <label>Ø§Ù„Ù†Øµ Ø§Ù„ÙˆØµÙÙŠ (Prompt)</label>
    <textarea id="prompt" rows="3">ØºØ§Ø¨Ø© Ø®Ø¶Ø±Ø§Ø¡ ÙÙŠÙ‡Ø§ Ù†Ù‡Ø± ÙˆØ¶ÙˆØ¡ ØºØ±ÙˆØ¨ Ø§Ù„Ø´Ù…Ø³ Ø¨Ø£Ø³Ù„ÙˆØ¨ ÙˆØ§Ù‚Ø¹ÙŠ</textarea>

    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø·ÙˆØ§Øª (Steps)</label>
    <input id="steps" type="number" value="20" min="10" max="50" />

    <label>Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©</label>
    <select id="size">
      <option value="512x512">512 Ã— 512</option>
      <option value="768x512">768 Ã— 512</option>
      <option value="512x768">512 Ã— 768</option>
    </select>

    <button id="generate">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø©</button>
    <p id="status">Ø§Ù„Ø­Ø§Ù„Ø©: Ø¬Ø§Ù‡Ø²</p>
    <img id="result" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ø§ØªØ¬Ø©" />
  </div>

  <footer>
    <p>ÙŠØ¹Ù…Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <a href="https://aihorde.net/" target="_blank">AI Horde</a> API Ø§Ù„Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø±.</p>
  </footer>
</main>

<script>
const btn = document.getElementById("generate");
const promptEl = document.getElementById("prompt");
const stepsEl = document.getElementById("steps");
const sizeEl = document.getElementById("size");
const statusEl = document.getElementById("status");
const resultEl = document.getElementById("result");

async function setStatus(msg){ statusEl.textContent = "Ø§Ù„Ø­Ø§Ù„Ø©: " + msg; }

btn.addEventListener("click", async ()=>{
  const prompt = promptEl.value.trim();
  if(!prompt){ alert("Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹."); return; }

  const steps = parseInt(stepsEl.value) || 20;
  const size = sizeEl.value.split("x");
  const width = parseInt(size[0]);
  const height = parseInt(size[1]);

  btn.disabled = true;
  setStatus("Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ AI Horde...");

  try{
    const request = await fetch("https://aihorde.net/api/v2/generate/async", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Client-Agent": "AI-Image-Generator-HTML:1.0"
      },
      body: JSON.stringify({
        prompt,
        params: {
          width,
          height,
          steps,
          n: 1,
          sampler_name: "k_euler_a"
        },
        nsfw: false
      })
    });

    const data = await request.json();
    if(!data.id) throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ù‡Ù…Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….");

    const jobId = data.id;
    setStatus("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ØªÙÙˆÙ„Ù‘Ø¯ Ø§Ù„ØµÙˆØ±Ø©...");

    let finished = false, imageData = null;
    while(!finished){
      await new Promise(r=>setTimeout(r, 4000));
      const check = await fetch(`https://aihorde.net/api/v2/generate/status/${jobId}`);
      const checkData = await check.json();

      if(checkData.done){
        finished = true;
        if(checkData.generations && checkData.generations[0]){
          imageData = checkData.generations[0].img;
        }
      }else{
        setStatus(`Ø§Ù„ØµÙˆØ± Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©... (${checkData.wait_time.toFixed(1)} Ø«Ø§Ù†ÙŠØ© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹)`);
      }
    }

    if(imageData){
      resultEl.src = imageData;
      setStatus("âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!");
    }else{
      throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….");
    }

  }catch(err){
    console.error(err);
    setStatus("âŒ ÙØ´Ù„: " + err.message);
    alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙˆÙ„ÙŠØ¯. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.");
  }

  btn.disabled = false;
});
</script>
</body>
</html>
